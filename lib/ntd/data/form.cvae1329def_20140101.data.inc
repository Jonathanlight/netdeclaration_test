<?php

$operations = array(
  'calcul-d' => array('func' => 'data-calc-d',
                      'opt' => array('results' => array('BB'),
                                     'operands' => array('BC', 'AA', 'AB')),
  ),
  'calcul-b' => array('func' => 'data-calc-b',
                      'opt' => array('results' => array('AC'),
                                     'operands' => array('AA', 'AD')),
  ),
/*
  'cotisation-minimum' => array('func' => 'data-cotisation-minimum',
                                'opt' => array('items' => array('CH', 'AA', 'EA', 'CG')),
  ),
*/
  'cotisation-minimum' => array('func' => 'data-cotisation-minimum',
                                'opt' => array('items' => array('AA', 'AD', 'EA', 'CB', 'DA', 'DB')),
  ),
  'cotisation-avant-reduction' => array('func' => 'data-cotisation-avant-reduction',
                                        'opt' => array('items' => array('CB', 'AA', 'CA')),
  ),
  'montant-cotisation' => array('func' => 'data-montant-cotisation',
                                'opt' => array('items' => array('AC', 'BA', 'BB', 'BC', 'CA')),
  ),
  'calcul-f' => array('func' => 'data-calc-f',
                      'opt' => array('items' => array('CB', 'AA', 'CA')),
  ),


  'soustraction-co' => array('func' => 'data-soustraction', 'opt' => array('results' => array('CO'), 'value' => 'CK', 'operands' => array('CJ')),),
  'soustraction-cn' => array('func' => 'data-soustraction', 'opt' => array('results' => array('CN'), 'value' => 'CJ', 'operands' => array('CK', 'CL')),),
  'addition-cj' => array('func' => 'data-addition', 'opt' => array('results' => array('CJ'), 'operands' => array('CH', 'CI'))),
  'frais-gestion' => array('func' => 'data-frais-gestion', 'opt' => array('items' => array('CI', 'CH', 'CL')),),
  'paiement-cvae1329def' => array('function' => 'paiement', 'args' => array('field' => 'KA')),

  //'calculEA' => array('func' => 'data-soustraction', 'opt' => array('results' => array('EA'), 'value' => 'CB', 'operands' => array('DA', 'DB'), 'args' => array())),
  'calculEC' => array('func' => 'data-soustraction', 'opt' => array('results' => array('EC'), 'value' => 'EA', 'operands' => array('EB'))),
  'calculED' => array('func' => 'data-soustraction', 'opt' => array('results' => array('ED'), 'value' => 'EB', 'operands' => array('EA'))),
  'calculGB' => array('function' => 'ifCheckboxThenMultiplyFieldByPercent',
                      'args' => array('result_field' => 'GB',
                                      'field' => 'EA',
                                      'checkbox' => 'GA',
                                      'percent' => 0.06304)),
  'calculGD' => array('func' => 'data-soustraction', 'opt' => array('results' => array('GD'), 'value' => 'GB', 'operands' => array('GC'))),
  'calculGE' => array('func' => 'data-soustraction', 'opt' => array('results' => array('GE'), 'value' => 'GC', 'operands' => array('GB'))),
  'calculHA' => array('function' => 'itemsSumAndPercent',
                      'args' => array('result_field' => 'HA',
                                      'items' => array('EA', 'GB'),
                                      'percent' => 0.01)),
  'calculHC' => array('func' => 'data-soustraction', 'opt' => array('results' => array('HC'), 'value' => 'HA', 'operands' => array('HB'))),
  'calculHD' => array('func' => 'data-soustraction', 'opt' => array('results' => array('HD'), 'value' => 'HB', 'operands' => array('HA'))),
  'calculJA' => array('func' => 'data-addition', 'opt' => array('results' => array('JA'), 'operands' => array('EB', 'GC', 'HB'))),
  'calculJB' => array('func' => 'data-addition', 'opt' => array('results' => array('JB'), 'operands' => array('EC', 'GD', 'HC'))),
  'calculJD' => array('func' => 'data-soustraction', 'opt' => array('results' => array('JD'), 'value' => 'JB', 'operands' => array('JC'))),
  'calculJE' => array('func' => 'data-addition', 'opt' => array('results' => array('JE'), 'operands' => array('ED', 'GE', 'HD'))),

  'calculKA' => array('func' => 'data-soustraction', 'opt' => array('results' => array('KA'), 'value' => 'JD', 'operands' => array('JE'))),
  'calculKB' => array('func' => 'data-soustraction', 'opt' => array('results' => array('KB'), 'value' => 'JE', 'operands' => array('JD'))),
  'only-AA-or-AD' => array('function' => 'onlyOneInputFilled', 'args' => array('items' => array('AA', 'AD')))
);
                        
$operations['calculKA'];


$form["cvae1329def_20140101"] = array(
  'AA' => array('type' => 'number',
                'operations' => array($operations['calcul-d'],
                                      $operations['calcul-b'],
                                      $operations['cotisation-avant-reduction'],
                                      $operations['only-AA-or-AD'],
                                      $operations['cotisation-minimum'],
                ),
  ),
  'AB' => array('type' => 'number',
                'operations' => array($operations['calcul-d'],
                                      $operations['calcul-b'],
                ),
  ),
  'AC' => array('type' => 'pourcentage',
                'operations' => array($operations['montant-cotisation'],
                                      $operations['calcul-f'],
                ),
  ),
  'AD' => array('type' => 'number',
                'operations' => array($operations['calcul-b'], $operations['only-AA-or-AD'], $operations['cotisation-minimum']),
  ),
  'BA' => array('type' => 'number',
                'operations' => array($operations['montant-cotisation'],),
  ),
  'BB' => array('type' => 'number',
                'operations' => array(),
  ),
  'BC' => array('required' => false,
                'type' => 'checkbox',
                'value' => '1',
                'operations' => array($operations['montant-cotisation'],$operations['calcul-d']),
  ),
  'CA' => array('type' => 'number',
                'operations' => array($operations['calcul-f'],
                                      $operations['cotisation-avant-reduction'],
                ),
  ),
  'CB' => array('type' => 'number',
                'operations' => array($operations['cotisation-minimum']),
  ),


  'DA' => array('type' => 'number',
                'operations' => array($operations['cotisation-minimum'])
  ),
  'DB' => array('type' => 'number',
                'operations' => array($operations['cotisation-minimum']),
  ),
  'EA' => array('type' => 'number',
                'operations' => array($operations['suborzero'], $operations['calculEC'], $operations['calculED'], $operations['calculGB'], $operations['calculHA']),
  ),
  'EB' => array('type' => 'number',
                'operations' => array($operations['calculEC'], $operations['calculED'], $operations['calculJA']),
  ),
  'EC' => array('type' => 'number',
                'operations' => array($operations['calculJB']),
  ),
  'ED' => array('type' => 'number',
                'operations' => array($operations['calculJE']),
  ),
  'GA' => array('type' => 'checkbox',
                'operations' => array($operations['calculGB']),
  ),
  'GB' => array('type' => 'number',
                'operations' => array($operations['calculGD'], $operations['calculGE'], $operations['calculHA']),
  ),
  'GC' => array('type' => 'number',
                'operations' => array($operations['calculGD'], $operations['calculGE'], $operations['calculJA']),
  ),
  'GD' => array('type' => 'number',
                'operations' => array($operations['calculJB']),
  ),
  'GE' => array('type' => 'number',
                'operations' => array($operations['calculJE']),
  ),
  'HA' => array('type' => 'number',
                'operations' => array($operations['calculHC'], $operations['calculHD']),
  ),
  'HB' => array('type' => 'number',
                'operations' => array($operations['calculHC'], $operations['calculHD'], $operations['calculJA']),
  ),
  'HC' => array('type' => 'number',
                'operations' => array($operations['calculJB']),
  ),
  'HD' => array('type' => 'number',
                'operations' => array($operations['calculJE']),
  ),
  'JA' => array('type' => 'number',
                'operations' => array(),
  ),
  'JB' => array('type' => 'number',
                'operations' => array($operations['calculJD']),
  ),
  'JC' => array('type' => 'number',
                'operations' => array($operations['calculJD']),
  ),
  'JD' => array('type' => 'number',
                'operations' => array($operations['calculKA'], $operations['calculKB']),
  ),
  'JE' => array('type' => 'number',
                'operations' => array($operations['calculKA'], $operations['calculKB']),
  ),
  'KA' => array('type' => 'number', 'operations' => array($operations['paiement-cvae1329def'])
  ),
  'KB' => array('type' => 'number'
  ),  

);
